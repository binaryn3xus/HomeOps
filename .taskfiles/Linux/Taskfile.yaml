---
# yaml-language-server: $schema=https://taskfile.dev/schema.json
version: "3"

tasks:

  backup-wsl:
    desc: Backup WSL Configurations
    cmds:
      # Backup Brew
      - mkdir -p ./backups/brew/
      - brew bundle dump -f
      - mv Brewfile ./backups/brew/Brewfile
      # Backup K9s
      - mkdir -p ./backups/k9s/
      - cp ~/.config/k9s/config.yml ./backups/k9s/config.yml
      # Backup Fish
      - mkdir -p ./backups/fish/
      - cp ~/.config/fish/config.fish ./backups/fish/config.fish
      - cp ~/.config/fish/fish_plugins ./backups/fish/fish_plugins
      - cp ~/.config/fish/fish_variables ./backups/fish/fish_variables
      # Warn that kubeconfig will not be backed up
      - echo -e "\033[33mKubeconfig will not be backed up for security reasons\033[0m"

  restore-wsl:
    desc: Restore WSL Configurations
    cmds:
      # Restore Brew
      - cp ./backups/brew/Brewfile Brewfile
      - brew bundle install
      - rm Brewfile && rm Brewfile.lock.json
      # Restore K9s
      - mkdir -p ~/.config/k9s/
      - cp ./backups/k9s/config.yml ~/.config/k9s/config.yml
      # Restore Fish
      - mkdir -p ~/.config/fish/
      - cp ./backups/fish/config.fish ~/.config/fish/config.fish
      - cp ./backups/fish/fish_plugins ~/.config/fish/fish_plugins
      - cp ./backups/fish/fish_variables ~/.config/fish/fish_variables

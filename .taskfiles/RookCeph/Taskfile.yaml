---
# yaml-language-server: $schema=https://taskfile.dev/schema.json
version: "3"

vars:
  PYTHON_BIN: python3

env:
  PATH: "{{.ROOT_DIR}}/.venv/bin:$PATH"
  VIRTUAL_ENV: "{{.ROOT_DIR}}/.venv"
  ANSIBLE_COLLECTIONS_PATH: "{{.ROOT_DIR}}/.venv/galaxy"
  ANSIBLE_ROLES_PATH: "{{.ROOT_DIR}}/.venv/galaxy/ansible_roles"
  ANSIBLE_VARS_ENABLED: "host_group_vars,community.sops.sops"

tasks:

  nuke-rook-data:
    desc: Nuke all rook ceph drives
    dir: "{{.ANSIBLE_DIR}}"
    interactive: true
    cmds:
      - "ansible-playbook -i {{.ANSIBLE_DIR}}/inventory/hosts.yaml {{.ANSIBLE_DIR}}/playbooks/rook-ceph-reset-drives.yml"
